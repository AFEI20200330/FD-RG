# Fraud detection and response generation system（FD-RG）
Hey,guys.<br>
I'm trying to build a system to detect the fraud chatting content and use response generated by the NLP and AI to waste the criminals' cheating.<br>
一个实时聊天监控系统，利用自然语言处理（NLP）和神经网络模型，对聊天记录进行诈骗判断。如果判断为诈骗，系统将主动回复（“拖延回复”）耗费诈骗人员时间；如果判断为正常，则消息直接透传给前端。


After learning about Golang,MYSQL redis and kafka,and I noticed the news about the anti-fraud AI chatting bot a few days ago,
I'm trying to build a system to detect the fraud chatting content and use response generated by the NLP and AI to waste the criminals'
cheating.

It's just a demo and have not applied yet.



## System structure

### FrontEnd:
Accept user's input and send it to kafka queue.

### Kafka:
A distributed messaging system that can handle large volumes of data.
As buffer layer, it can store the messages and deliver them to the backend.
It will ensure that the messages are delivered in the order they were sent and avoid the Message backlog problem under high-throughput scenarios.

### Service handler:
A service that receives the messages from kafka and processes them.
It will use NLP and AI models to detect the fraud chatting content.<br>
#### Kafka consumer: <br>
1.consume the messages from the kafka queue and store them in the MYSQL database.<br>
                2.use backend API to use the NLP and AI models to detect the fraud chatting content.<br>
                3.Automatically reply to the user:if the chatting content is detected as fraud, generate the response using the NLP and AI models and send it to the kafka queue.<br>

#### Model:
A neural network model that can detect the fraud chatting content. And it will generate the response using the NLP model.
My NLP and AI models skills are limited.

## Database:
A MYSQL database that stores the chatting messages and the response generated by the NLP and AI models.
Redis: A key-value store that can be used to store the user's chatting history and the response generated by the NLP and AI models.

MYSQL database schema:
```MYSQL
CREATE TABLE `chat_logs` (
`id` VARCHAR(64) NOT NULL COMMENT '消息ID，唯一标识',
`session_id` VARCHAR(64) NOT NULL COMMENT '会话ID，同一会话的消息一致',
`sender` VARCHAR(20) NOT NULL COMMENT '发送者标识',
`content` TEXT NOT NULL COMMENT '消息内容',
`timestamp` DATETIME NOT NULL COMMENT '消息时间戳',
PRIMARY KEY (`id`),
KEY `idx_session` (`session_id`),
KEY `idx_timestamp` (`timestamp`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='聊天记录表';
```
## Redis database set:
```REDIS
//每个会话使用一个 key，如 session:{session_id}:history，数据类型为 List（使用 RPUSH 追加记录），保证消息顺序。
// 设置 key 的过期时间为 7 天
redisClient.Expire(key, 7*24*time.Hour)
```

## Kafka:
Topics:
chat_messages：前端发送的聊天消息，分区建议按会话ID hash 分配，确保同一会话消息顺序一致。
chat_responses：系统回复消息，供前端接收系统的应答回复。
消费者组
Golang 服务使用 Kafka 消费者组，配合 Sarama 客户端实现消费、错误重试以及平滑重分区。

